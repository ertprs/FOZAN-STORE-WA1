<!DOCTYPE html>
<html lang="en">
  <title>Preact Demo</title>
  <script type="module">
    import { h, render } from "https://unpkg.com/preact@latest?module";
    import { useState, useEffect } from "https://unpkg.com/preact@latest/hooks/dist/hooks.module.js?module";
    import htm from "https://unpkg.com/htm@latest/dist/htm.module.js?module";
    const SEARCH = "https://api.github.com/search/repositories";

    const html = htm.bind(h);
    
    const Example = () => {
      const [items, setItems] = useState([]);
      const [txt,setTxt] = useState('');

      useEffect(() => {
        fetch(`${SEARCH}?q=preact`)
          .then(res => res.json())
          .then(data => setItems((data && data.items) || []));
      }, []);

      var onInput = function(e) {
        //console.log(e);
        setTxt(e.target.value);
      }
      var send = function() {
        console.log(txt);  
      }
      
      return html`
        <div>
          <h1 style="text-align:center; font-weight: 200">Example</h1>
          <input value='${txt}' onInput='${onInput}'/><button onClick='${send}'>Send</button>
          <div class="list">
            ${items.map(res => html`
                <${Result} result=${res} />
              `)}
          </div>
        </div>
      `;
    }

    const Result = ({result}) =>
      html`
        <div class="repl-list-item">
          <div>
            <a
              href="${result.html_url}"
              target="_blank"
              rel="noopener noreferrer"
              class="repl-link"
            >
              ${result.full_name}
            </a>
            ${" - "}
            <strong>${result.stargazers_count}</strong>
          </div>
          <p>${result.description}</p>
        </div>
      `;

    render(h(Example), document.body);
  </script>
</html>
